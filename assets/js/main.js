function calculateOptimization(e,t,n,o){var o=t*({denver:1,phoenix:1.3,seattle:.7,miami:1.1}[o]||1)*1460,a=8760*e,r=Math.min(o/a*100,95),t=1200*t+400*n,n=Math.min(o,a);return{lcoe:.08*t/n,npc:t+.05*e*8760*15,renewable:r,co2:n*r/100*.4/1e3}}function updateResultsChart(e){window.resultsChart&&(e=e.renewable,window.resultsChart.data.datasets[0].data=[.7*e,.1*e,.2*e,100-e],window.resultsChart.update())}function debounce(t,n){let o;return function(...e){clearTimeout(o),o=setTimeout(()=>{clearTimeout(o),t(...e)},n)}}function showLoading(e){e.style.opacity="0.6",e.style.pointerEvents="none"}function hideLoading(e){e.style.opacity="1",e.style.pointerEvents="auto"}function updateScrollProgress(){var e=(window.pageYOffset||document.documentElement.scrollTop)/(document.documentElement.scrollHeight-window.innerHeight)*100;document.body.style.setProperty("--scroll-progress",e+"%"),document.documentElement.style.setProperty("--scroll-width",e+"%")}document.addEventListener("DOMContentLoaded",function(){updateScrollProgress(),window.addEventListener("scroll",updateScrollProgress);var e=document.querySelector(".mobile-menu-toggle");let t=document.querySelector(".mobile-menu"),n=document.querySelector(".hamburger"),o=(e&&t&&e.addEventListener("click",function(){t.classList.toggle("hidden"),n.classList.toggle("active")}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();e=document.querySelector(this.getAttribute("href"));e&&e.scrollIntoView({behavior:"smooth",block:"start"})})}),document.querySelector(".header")),a=0,r=(window.addEventListener("scroll",function(){var e=window.pageYOffset||document.documentElement.scrollTop;e>a&&100<e?o.style.transform="translateY(-100%)":o.style.transform="translateY(0)",a=e}),document.getElementById("load")),i=document.getElementById("pv-capacity"),l=document.getElementById("battery-capacity"),d=document.getElementById("location"),c=document.getElementById("calculate-btn"),s=document.getElementById("load-value"),u=document.getElementById("pv-value"),m=document.getElementById("battery-value");r&&s&&r.addEventListener("input",function(){s.textContent=this.value+" kW"}),i&&u&&i.addEventListener("input",function(){u.textContent=this.value+" kW"}),l&&m&&l.addEventListener("input",function(){m.textContent=this.value+" kWh"}),c&&c.addEventListener("click",function(){var e=calculateOptimization(parseInt(r.value),parseInt(i.value),parseInt(l.value),d.value);document.getElementById("lcoe-result").textContent="$"+e.lcoe.toFixed(3)+"/kWh",document.getElementById("npc-result").textContent="$"+(e.npc/1e6).toFixed(1)+"M",document.getElementById("renewable-result").textContent=e.renewable.toFixed(0)+"%",document.getElementById("co2-result").textContent=e.co2.toFixed(0)+" tons/year",updateResultsChart(e),c.textContent="Calculating...",c.disabled=!0,setTimeout(()=>{c.textContent="Calculate Optimization",c.disabled=!1},1500)});var e=document.getElementById("results-chart");e&&"undefined"!=typeof Chart&&(e=e.getContext("2d"),new Chart(e,{type:"doughnut",data:{labels:["Solar PV","Wind","Battery","Grid/Genset"],datasets:[{data:[45,15,25,15],backgroundColor:["#f59e0b","#10b981","#3b82f6","#64748b"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:20,font:{size:12}}}}}}));let p=new IntersectionObserver(function(e){e.forEach(e=>{e.isIntersecting&&e.target.classList.add("fade-in-up")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll(".feature-card, .metric").forEach(e=>{p.observe(e)})});let enhancedObserver=new IntersectionObserver(function(e){e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("fade-in-up"),e.target.querySelectorAll(".feature-card, .metric").forEach((e,t)=>{setTimeout(()=>{e.classList.add("fade-in-up")},100*t)}))})},{threshold:.1,rootMargin:"0px 0px -10% 0px"});function typeWriterEffect(){let o=document.querySelector(".hero-title");if(o){let t=o.textContent,n=(o.textContent="",o.style.borderRight="2px solid var(--primary)",0);setTimeout(function e(){n<t.length?(o.textContent+=t.charAt(n),n++,setTimeout(e,50)):setTimeout(()=>{o.style.borderRight="none"},1e3)},500)}}function addLoadingAnimation(){let e=document.body;e.classList.add("loading"),window.addEventListener("load",()=>{setTimeout(()=>{e.classList.remove("loading")},300)})}document.querySelectorAll(".section, .hero, .metrics-banner").forEach(e=>{enhancedObserver.observe(e)}),addLoadingAnimation(),window.PyMicrogridWeb={calculateOptimization:calculateOptimization,updateResultsChart:updateResultsChart,showLoading:showLoading,hideLoading:hideLoading,updateScrollProgress:updateScrollProgress};